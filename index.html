<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Historiska händelser - GLADSTART</title>
    <style>
        :root {
            --gladstart-orange: #e67e22;
            --gladstart-orange-light: #f39c12;
            --gladstart-orange-dark: #d35400;
            --gladstart-bg: #f9f3e9;
            --gladstart-text: #3c3c3b;
            --gladstart-text-secondary: #636363;
            --gladstart-brown: #4a3520;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--gladstart-text);
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: var(--gladstart-bg);
            text-align: center;
        }
        .logo {
            width: 120px; /* Reduced size */
            margin: 10px auto 20px; /* Reduced margins */
        }
        header {
            margin-bottom: 1rem; /* Reduced bottom margin */
        }
        h1 {
            color: var(--gladstart-brown);
            margin-bottom: 1rem;
            font-size: 1.8rem;
        }
        .date-display {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--gladstart-orange-dark);
            margin-bottom: 2rem;
        }
        .event-card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            padding: 20px;
            margin-bottom: 20px;
            transition: transform 0.2s;
            text-align: left;
        }
        .event-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .event-year {
            display: inline-block;
            background-color: var(--gladstart-orange);
            color: white;
            padding: 0.2rem 0.6rem;
            border-radius: 4px;
            font-weight: bold;
            margin-right: 8px;
        }
        .event-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        .event-description {
            margin-top: 0.8rem;
            color: var(--gladstart-text-secondary);
        }
        .event-source {
            margin-top: 0.8rem;
            font-size: 0.9rem;
            color: var(--gladstart-text-secondary);
            text-align: right;
        }
        .event-source a {
            color: var(--gladstart-orange);
            text-decoration: none;
        }
        .event-source a:hover {
            text-decoration: underline;
        }
        .region-badge {
            display: inline-block;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: 8px;
        }
        .region-Sweden {
            background-color: #FECC02;
            color: #006AA7;
        }
        .region-Nordic {
            background-color: #0073cf;
            color: white;
        }
        .region-Europe {
            background-color: #039;
            color: #fc0;
        }
        .region-Global {
            background-color: #4caf50;
            color: white;
        }
        .loading {
            text-align: center;
            padding: 2rem;
            font-style: italic;
            color: var(--gladstart-text-secondary);
        }
        footer {
            margin-top: 3rem;
            text-align: center;
            font-size: 0.9rem;
            color: var(--gladstart-text-secondary);
            padding-top: 2rem;
        }
        .social-icons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }
        .social-icons a {
            color: var(--gladstart-text-secondary);
            text-decoration: none;
            font-size: 1.5rem;
        }
        .social-icons a:hover {
            color: var(--gladstart-orange);
        }
        .email-signup {
            margin: 40px auto;
            max-width: 600px;
        }
        .email-signup p {
            margin-bottom: 20px;
            font-size: 1.1rem;
            color: var(--gladstart-brown);
        }
        .iframe-container {
            margin: 20px auto;
            max-width: 450px;
            display: flex;
            justify-content: center;
        }
        .copyright {
            margin-top: 20px;
            font-size: 0.8rem;
        }
        a {
            color: #6f4e37;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <header>
        <div class="logo">
            <img src="gladstart-logo.png" alt="GLADSTART Logo" width="120">
        </div>
        <h1>Historiska händelser i dag</h1>
        <div class="date-display" id="currentDate">Laddar dagens datum...</div>
    </header>
    
    <main id="eventsContainer">
        <div class="loading">Laddar historiska händelser...</div>
    </main>

    <div class="email-signup">
        <p>Vi skickar ut glädjande nyheter och hjärtevärmande berättelser till dig varje måndag och när något extra kul händer!</p>
        <div class="iframe-container">
            <iframe src="https://gladstart.curated.co/embed?color1=f5efe7&color2=4a3520&color_bg_button=e67e22&color_border=f39c12&color_button=ffffff&color_links=6f4e37&color_terms=967259&title=Join+GladStart+%F0%9F%98%8A+" width="450" height="310" frameborder="0" style="max-width: 100%"></iframe>
        </div>
    </div>

    <footer>
        <div class="social-icons">
            <a href="#" aria-label="Facebook" target="_blank"><i class="fab fa-facebook-f"></i></a>
            <a href="#" aria-label="Twitter" target="_blank"><i class="fab fa-twitter"></i></a>
            <a href="#" aria-label="Instagram" target="_blank"><i class="fab fa-instagram"></i></a>
            <a href="#" aria-label="LinkedIn" target="_blank"><i class="fab fa-linkedin-in"></i></a>
        </div>
        <div class="copyright">
            ©2025 GladStart | <a href="#" target="_blank">Användarvillkor</a> | <a href="#" target="_blank">Integritetspolicy</a>
        </div>
        <div style="margin-top: 10px; font-size: 0.8rem;">
            This site is protected by reCAPTCHA and the Google Privacy Policy and Terms of Service apply.
        </div>
    </footer>

    <script>
        // Path to your JSON data file
        const DATA_PATH = 'data/historical_events.json';
        
        // Region names in Swedish
        const regionTranslations = {
            'Sweden': 'Sverige',
            'Nordic': 'Norden',
            'Europe': 'Europa',
            'Global': 'Global'
        };
        
        // Create Wikipedia URL based on language and title
        function createWikipediaUrl(language, title) {
            // For Swedish Wikipedia
            if (language && language.includes('sv')) {
                return `https://sv.wikipedia.org/wiki/${encodeURIComponent(title.replace(/\s/g, '_'))}`;
            }
            // For English Wikipedia
            else if (language && language.includes('en')) {
                return `https://en.wikipedia.org/wiki/${encodeURIComponent(title.replace(/\s/g, '_'))}`;
            }
            // Default to Swedish
            else {
                return `https://sv.wikipedia.org/wiki/Huvudsida`;
            }
        }
        
        // Format date as Month Day (e.g., "14 mars")
        function formatDate(date) {
            // Swedish month names
            const monthNames = [
                "januari", "februari", "mars", "april", "maj", "juni", 
                "juli", "augusti", "september", "oktober", "november", "december"
            ];
            
            const day = date.getDate();
            const month = monthNames[date.getMonth()];
            
            return `${day} ${month}`;
        }
        
        // Get current date information
        function getCurrentDateInfo() {
            const now = new Date();
            const month = now.getMonth() + 1; // JavaScript months are 0-based
            const day = now.getDate();
            
            return {
                display: formatDate(now),
                month: month,
                day: day
            };
        }
        
        // Filter events for the current date (only Swedish and English)
        function filterEventsForDate(events, month, day) {
            return events.filter(event => 
                event.month === month && 
                event.day === day && 
                (!event.language || event.language.includes('sv') || event.language.includes('en'))
            );
        }
        
        // Create HTML for a single event
        function createEventHTML(event) {
            // Translate region name to Swedish
            const regionName = regionTranslations[event.region] || event.region;
            
            // Create Wikipedia URL
            const wikiUrl = createWikipediaUrl(event.language || 'sv', event.title);
            
            return `
                <div class="event-card">
                    <div>
                        <span class="event-year">${event.year}</span>
                        <span class="event-title">${event.title.substring(event.year.toString().length + 2)}</span>
                        <span class="region-badge region-${event.region}">${regionName}</span>
                    </div>
                    <div class="event-description">${event.description}</div>
                    <div class="event-source">Källa: <a href="${wikiUrl}" target="_blank" rel="noopener noreferrer">${event.source || 'Wikipedia'}</a></div>
                </div>
            `;
        }
        
        // Display events for today
        async function displayEventsForToday() {
            const dateInfo = getCurrentDateInfo();
            document.getElementById('currentDate').textContent = dateInfo.display;
            
            try {
                // Fetch historical events from JSON file
                const response = await fetch(DATA_PATH);
                if (!response.ok) {
                    throw new Error('Failed to load historical events data');
                }
                
                const allEvents = await response.json();
                const todaysEvents = filterEventsForDate(allEvents, dateInfo.month, dateInfo.day);
                
                const eventsContainer = document.getElementById('eventsContainer');
                
                if (todaysEvents.length === 0) {
                    eventsContainer.innerHTML = '<p>Inga historiska händelser hittades för idag.</p>';
                    return;
                }
                
                // Sort events by year (newest to oldest)
                todaysEvents.sort((a, b) => b.year - a.year);
                
                // Create HTML for all events
                const eventsHTML = todaysEvents.map(createEventHTML).join('');
                eventsContainer.innerHTML = eventsHTML;
                
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('eventsContainer').innerHTML = `
                    <div class="event-card">
                        <p>Ett fel uppstod vid laddning av historiska händelser. Kontrollera att data/historical_events.json finns.</p>
                        <p>Tekniska detaljer: ${error.message}</p>
                    </div>
                `;
                // Show demo events as fallback
                showDemoEvents();
            }
        }
        
        // Alternative function for demonstration without the JSON file
        function showDemoEvents() {
            const dateInfo = getCurrentDateInfo();
            document.getElementById('currentDate').textContent = dateInfo.display;
            
            // Example events for demonstration - all in Swedish
            const demoEvents = [
                {
                    year: 1781,
                    title: "1781: William Herschel upptäcker planeten Uranus",
                    description: "Den tysk-brittiske astronomen William Herschel 'officiellt' upptäcker planeten Uranus. Den har tidigare observerats av andra astronomer, men har dittills misstolkats som en stjärna. Med den svenske astronomen Eric Prosperins hjälp räknar man ut att himlakroppen har en nästan cirkelformad omloppsbana och att den därför måste vara en planet.",
                    source: "Wikipedia (sv)",
                    region: "Sweden",
                    language: "sv"
                },
                {
                    year: 1940,
                    title: "1940: Finska vinterkriget avslutas",
                    description: "Sedan Finland och Sovjetunionen föregående dag har undertecknat ett fredsavtal avslutas finska vinterkriget, som utbröt 30 november 1939, klockan 11.00. Finland tvingas i freden avträda stora landområden, däribland betydande delar av Karelen.",
                    source: "Wikipedia (sv)",
                    region: "Nordic",
                    language: "sv"
                },
                {
                    year: 1894,
                    title: "1894: Världens första stripteaseshow äger rum",
                    description: "Världens första stripteaseshow äger rum på varietéteatern Divan Fayonau i Paris. Föreställningen heter Le Coucher d'Yvette och visar hur en flicka klär av sig inför sitt sänggående.",
                    source: "Wikipedia (sv)",
                    region: "Europe",
                    language: "sv"
                },
                {
                    year: 251,
                    title: "251: Cornelius väljs till påve",
                    description: "Sedan Fabianus har avlidit föregående år, väljs Cornelius till påve (denna dag, 6 eller 11 mars).",
                    source: "Wikipedia (sv)",
                    region: "Global",
                    language: "sv"
                }
            ];
            
            const eventsContainer = document.getElementById('eventsContainer');
            const eventsHTML = demoEvents.map(createEventHTML).join('');
            eventsContainer.innerHTML = eventsHTML;
        }
        
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            // Try to load actual events, fall back to demo if needed
            displayEventsForToday().catch(error => {
                console.warn('Falling back to demo events:', error);
                showDemoEvents();
            });
        });
        
        // Generate HTML content for email newsletter
        function generateNewsletterContent() {
            // This function can be called to generate HTML for including in a newsletter
            const dateInfo = getCurrentDateInfo();
            const todaysEvents = filterEventsForDate(allEvents, dateInfo.month, dateInfo.day);
            
            let htmlContent = `
                <h2>Historiska händelser - ${dateInfo.display}</h2>
                <p>Här är några positiva historiska händelser som inträffade på denna dag:</p>
            `;
            
            // Include top 3 events
            const topEvents = todaysEvents.slice(0, 3);
            topEvents.forEach(event => {
                htmlContent += `
                    <div style="margin-bottom: 15px;">
                        <strong>${event.year}:</strong> ${event.description}
                    </div>
                `;
            });
            
            htmlContent += `
                <p>Se fler historiska händelser på <a href="https://today.gladstart.com" target="_blank">today.gladstart.com</a>!</p>
            `;
            
            return htmlContent;
        }
    </script>
</body>
</html>
